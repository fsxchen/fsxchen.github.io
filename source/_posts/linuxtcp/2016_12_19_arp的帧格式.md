---
title: arp的帧格式
date: 2016-12-19 20:34
category:
	- Misc
tags:
	- Misc
---
# arp的帧格式以及arp举例

## arp的帧和以太网帧格式对比

![arp的帧](http://7xrn62.com1.z0.glb.clouddn.com/be3be0846258e2778c7eede0ca67fc0a.png)
以太网的帧结构
![以太网帧结构](http://7xrn62.com1.z0.glb.clouddn.com/2022a3006b4e0a3b3dc0b3f2ea031e46.png)

| 字段             | 字段长度（字节） |                                                                        目的 |
|:-----------------|:----------------:|----------------------------------------------------------------------------:|
| 目的地址（DST）  |        6         |                                                                    目的地址 |
| 源地址（SRC）    |        6         |                                                                      源地址 |
| 长度或者类型     |        2         |                                                                长度或者类型 |
| 硬件类型         |        2         |                             指明了发送方想知道的硬件接口类型，以太网的值为1 |
| 协议类型         |        2         |                        指明了发送方提供的高层协议类型，IP为0800（16进制）； |
| 硬件的长度       |        1         |       指明了硬件地址长度，这样ARP报文就可以在任意硬件和任意协议的网络中使用 |
| 协议的长度       |        1         | 指明了高层协议地址的长度，这样ARP报文就可以在任意硬件和任意协议的网络中使用 |
| 操作类型         |        2         |    用来表示这个报文的类型，ARP请求为1，ARP响应为2，RARP请求为3，RARP响应为4 |
| 发送方的硬件地址 |        6         |                                                            发送放的硬件地址 |
| 发送放的协议地址 |        4         |                                                   发送方的协议地址，eg. IPv |
| 目标的硬件地址   |        6         |                                                              目标的硬件地址 |
| 目标的协议地址   |        4         |                                                              目标的协议地址 |




## arp举例


### 正常的访问

```sh
➜  ~ sudo tcpdump -e arp
```
输出：
```
tcpdump: data link type PKTAP
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on pktap, link-type PKTAP (Packet Tap), capture size 262144 bytes
21:14:28.443833 94:77:2b:88:80:6e (oui Unknown) > 70:71:bc:79:ae:a4 (oui Unknown), ethertype ARP (0x0806), length 42: Request who-has 192.168.3.5 tell 192.168.3.1, length 28
21:14:28.443853 70:71:bc:79:ae:a4 (oui Unknown) > 94:77:2b:88:80:6e (oui Unknown), ethertype ARP (0x0806), length 42: Reply 192.168.3.5 is-at 70:71:bc:79:ae:a4 (oui Unknown), length 28
21:14:36.448013 94:77:2b:88:80:6e (oui Unknown) > Broadcast, ethertype ARP (0x0806), length 60: Request who-has 192.168.3.71 tell 192.168.3.1, length 46
21:14:43.923325 dc:f0:90:87:22:bb (oui Unknown) > Broadcast, ethertype ARP (0x0806), length 42: Request who-has 192.168.3.3 tell 192.168.3.86, length 28
21:14:48.121289 e8:03:9a:cd:72:c8 (oui Unknown) > Broadcast, ethertype ARP (0x0806), length 42: Request who-has 192.168.3.65 tell 192.168.3.62, length 28
21:14:48.122152 02:22:6c:06:8f:d4 (oui Unknown) > Broadcast, ethertype ARP (0x0806), length 42: Request who-has 192.168.3.62 tell 192.168.3.65, length 28
```


### 访问地址不存在


### arp欺骗

![arp欺骗](http://7xrn62.com1.z0.glb.clouddn.com/ca2b6dcb10e0f3d0f9a076a349b6bbd7.png)
